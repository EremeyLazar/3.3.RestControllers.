<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
</head>
<body>

<!--TOPTOPTOPTOPTOPTOPTOPTOPTOPTOPTOPTOPTOPTOPTOPTOP-->


<div class="container text-center" style="background-color: lightslategrey; color: white; max-width: 100%;">
    <div class="row">
        <div class="col">
            <br>
            <span th:text="${sayhitoadmin}"></span> with roles
            <span th:if="${userRole}">
                <span th:each="role : ${userRole}">
                    <span th:text="${' ' + role.name + ', '}"></span>
                </span>
            </span>
            <br> <br>
        </div>
        <div class="col-6">

        </div>
        <div class="col ml-auto">
            <br>
            <a th:href="@{/logout}" style="color: white;">Logout</a>
            <br><br>
        </div>
    </div>
</div>

<!--MIDDLEMIDDLEMIDDLEMIDDLEMIDDLEMIDDLEMIDDLEMIDDLEMIDDLEMIDDLE-->


<div class="row">
    <div class="col-2 d-flex flex-column align-items-start justify-content-start">
        <br>
        <a href="/user" style="margin-left: 10px;"> USER</a>
        <a style="margin-left: 10px;"> ADMIN</a>
    </div>
    <div class="col-10" style="background-color: lightgray;">


        <h3>Admin panel.</h3>

        <ul class="nav nav-tabs">
            <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="admin.html">User's table</a>



            </li>

            <li class="nav-item">
                <a class="nav-link" href="/admin/newuser">New User</a>
            </li>

        </ul>

<br>
        <h6>All users:</h6>

        <table class="table table-striped-columns">
            <thead>
            <tr>
                <th scope="col">Id #</th>
                <th scope="col">Username</th>
                <th scope="col">Year of Birth</th>
                <th scope="col">Country of residence</th>
                <th scope="col">Roles</th>
                <th scope="col">Edit</th>
                <th scope="col">Delete</th>
            </tr>
            </thead>
            <tbody>
            <!-- Итерация по списку пользователей -->
            <tr th:each="user : ${userlist}">
                <td th:text="${user.id}"></td>
                <td th:text="${user.username}"></td>
                <td th:text="${user.yob}"></td>
                <td th:text="${user.country}"></td>
                <td>
                    <!-- Итерация по списку ролей каждого пользователя -->
                    <span th:each="role : ${user.roles}">
                    <span th:text="${role.name}"></span>
                    <br/>
                </span>
                </td>
                <td>

                    <!-- Кнопка Edit -->
                    <form th:action="@{/admin/update}" method="get" target="_blank">
                        <input type="hidden" name="id" th:value="${user.id}"/>
                        <button type="submit" class="btn btn-primary" onclick="openEditPopup(${user.id})">Edit</button>
                    </form>

                    <script>
                        function openEditPopup(userId) {
                            // Формируем URL с параметром пользователя
                            var url = '/admin/update?id=' + userId;

                            // Открываем всплывающее окно с переданным URL
                            window.open(url, 'editWindow', 'width=200,height=200,scrollbars=no');

                        }
                    </script>

                <td>
                    <!-- Кнопка Delete с параметром пользователя (ID, например) -->
                    <form th:action="@{/admin/delete}" method="post">
                        <input type="hidden" name="userId" th:value="${user.id}"/>
                        <!--                        <button type="submit">Delete</button>-->
                        <button type="submit" class="btn btn-danger">Delete</button>
                    </form>

                </td>


            </tr>
            </tbody>
        </table>

    </div>


</div>


<script src=" https:
    //cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
</body>
</html>